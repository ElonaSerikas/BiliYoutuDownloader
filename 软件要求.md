# B站视频下载器需求规格说明书（增强版）


## 一、项目概述
本项目旨在开发一款**跨平台（Windows/macOS/Linux）桌面端B站视频下载工具**，遵循Fluent Design设计原则，支持多线程并发、全量资源下载（含视频、弹幕、UP主数据等）与个性化界面定制，为用户提供高效、美观且合规的离线内容获取体验。


## 二、功能需求

### 1. 视频搜索与解析
- 支持输入B站视频链接（URL），自动解析视频信息（标题、缩略图、时长、可下载画质/音质列表等）。
- 实时展示解析结果，**预估并显示所选画质/音质对应的文件大小**，辅助存储判断。
- 支持**浏览器拖拽链接到软件窗口**的“集成下载”方式，直接触发解析。


### 2. 下载任务管理
- **任务分类管理**：分为「待下载」「下载中」「已下载」标签页，清晰区分任务状态。
  - 「待下载」：展示未开始的任务，支持“开始下载”“删除任务”。
  - 「下载中」：展示进行中的任务，实时显示**多线程下载进度（分片进度、总进度、速度）**，支持“暂停”“取消”。
  - 「已下载」：展示完成的任务，支持“打开文件”“打开存储目录”“删除记录”。
- **任务信息展示**：每个任务需显示缩略图、标题、文件大小（预估/实际）、时长、发布时间等关键信息。


### 3. 画质、音质与编码选择
- **画质选项**：支持B站全档画质（如360P、480P、720P、1080P/高码/高帧、4K、HDR、8K等，动态适配B站提供的画质，**会员画质需登录后解锁**）。
- **音质选项**：支持多档音质（如64K、132K、192K、杜比全景声、Hi-Res无损等，动态适配B站提供的音质）。
- **编码选择**：支持AVC1、AV01、HEV1等视频编码选择（与画质联动，展示可选编码）。


### 4. 存储与资源管理
- **存储路径自定义**：支持用户设置视频存储目录，提供“更改路径”“打开目录”功能。
- **附加资源下载**：可选择性下载视频封面、XML弹幕、ASS弹幕、单独音频文件，以及**历史弹幕、UP主简介、视频评论区内容**。


### 5. 登录与特权内容访问
- 支持**账号密码登录**、**Cookie导入登录**，获取登录态后解锁：
  - 会员专享画质（如4K高码率）、专属弹幕的下载权限；
  - 个人数据访问（收藏夹、合集等）。
- 支持**调用B站开放API**（合规申请后），获取用户个人数据（收藏夹、合集列表等）。


### 6. 用户与系统设置
- **用户模块**：显示登录状态（用户名、会员标识），提供“退出登录”功能。
- **系统通知**：支持“系统提示音”开关，下载完成/出错时给出声音反馈。
- **退出行为**：可选“退出程序”或“最小化到系统托盘”。
- **并发下载**：支持**自定义并发线程数（1 - 10线程可选）**，并在设置中可视化调整线程优先级。
- **文件命名**：支持默认命名（视频标题）或自定义命名规则。
- **界面定制**：
  - 支持设置**自定义背景图（主界面/侧边栏）**，并可调节背景遮罩透明度；
  - 左侧导航栏为**可折叠侧边栏**，点击可折叠/展开，节省屏幕空间。


### 7. 拓展资源下载
- 支持下载**视频合集**（自动识别合集中的多P视频并批量下载）。
- 支持下载**用户收藏夹**（读取登录用户的收藏夹列表，选择收藏夹批量下载内容）。
- 支持下载**UP主简介**（文本+头像资源）、**视频评论区**（热门评论及回复的文本导出）。


### 8. 日志与错误反馈
- **日志记录**：自动记录下载日志（时间、视频标题、画质、耗时、结果等），支持“导出日志”功能。
- **错误提醒**：下载失败时弹出明确的错误提示（含错误码、原因建议），并可选择“重试”“忽略”“查看详情”。


### 9. 署名与版权
- 软件启动页/“关于”界面显示**开发者署名、版权声明**（如“© 202X [开发者/团队名] 版权所有”），并链接开源协议（若开源）或使用条款。


## 三、界面需求

### 1. 整体布局与设计风格
- **Fluent Design 设计**：遵循微软Fluent Design原则，加入**亚克力材质（Acrylic）**、分层设计、动态视觉深度与过渡效果。
- **左侧可折叠侧边栏**：包含「搜索」「下载管理」「用户中心」「设置」等功能入口（图标+文字形式），支持点击折叠/展开。
- **自定义标题栏**：替代系统默认标题栏，设计包含软件Logo、功能按钮（最小化/最大化/关闭）的自定义标题区域，与整体风格统一。
- **主内容区**：根据左侧选中功能，动态显示搜索框、下载任务列表、设置面板等内容，窗口大小改变时**自适应重排界面元素**。


### 2. 各模块界面细节
- **搜索界面**：居中显示“输入链接”文本框与“搜索”按钮，支持**浏览器拖拽链接直接解析**，交互区域带有淡入动画。
- **下载管理界面**：
  - 标签页（「待下载」「下载中」「已下载」）切换时带有**滑动/淡入过渡动画**，选中态清晰。
  - 任务项包含缩略图、标题、关键信息（大小、时长）、操作按钮（如“下载”“暂停”“打开”），按钮点击有**颜色加深+轻微缩放反馈**。
- **画质/音质选择界面**：以下拉菜单或弹窗呈现，选项展开/收起带有**平滑动画**，选中项高亮且有动态标识。
- **设置界面**：设置项按“通知”“退出”“存储”“功能”“音质”“画质”等分组，单选/多选按钮操作时带有**状态切换动画**，重要操作（如“更改存储路径”）有明显按钮与反馈。


### 3. 视觉与交互增强
- **优雅动画**：所有界面切换（标签页、弹窗、侧边栏）、操作反馈（按钮点击、进度变化、错误提示弹出）都带有**平滑动画**（如淡入淡出、滑动、缩放）。
- **动态视觉深度**：通过阴影、分层、亚克力效果营造界面深度感，元素层级关系清晰。


## 四、技术需求

### 1. 跨平台兼容性
- 支持 **Windows 10及以上**、**macOS Ventura及以上**、**Linux（Ubuntu 20.04+/CentOS 8+等主流发行版）**，使用Electron（或Flutter Desktop、Tauri）实现跨平台，保证界面与功能一致性。


### 2. 视频解析与下载核心
- **多线程分片下载**：每个下载任务内部采用**分片多线程下载**（结合`worker_threads`或原生模块），提升大文件（如4K/8K视频）的下载速度与稳定性，支持断点续传（网络中断后恢复下载）。
- **登录与API封装**：封装B站登录接口（处理账号密码加密、Cookie持久化存储），以及API调用模块（统一处理请求头、签名、返回数据解析），确保登录态有效且请求合规。
- **资源解析拓展**：扩展解析逻辑，支持从B站API中提取合集、收藏夹、评论区、历史弹幕等数据结构，并转化为可下载任务。


### 3. 前端界面与交互技术
- **界面框架**：使用React + TypeScript（或Vue + TypeScript）构建界面，结合**Fluent UI组件库**（或自定义符合Fluent Design的组件）实现亚克力效果、动画过渡。
- **动画与交互**：基于CSS Transition/Animation + JS（`requestAnimationFrame`）实现流畅动画；对动画元素做**分层渲染与硬件加速**（如`transform: translateZ(0)`），防止卡顿。
- **自定义组件**：封装“可折叠侧边栏”“自定义标题栏”“背景遮罩”等通用组件，通过状态管理（如Redux、Pinia）控制交互逻辑。


### 4. 性能与稳定性
- **大文件处理**：采用**流式下载与写入**，避免大文件一次性加载到内存导致崩溃；利用系统原生文件API提升读写效率。
- **跨平台适配**：处理不同系统的路径分隔符、权限差异（如macOS沙盒权限、Linux文件权限），确保存储、资源访问无异常。


### 5. 日志与错误系统
- **日志模块**：设计分级日志类（INFO、WARN、ERROR），记录操作与错误，支持本地持久化与“导出日志”功能。
- **错误处理**：通过**事件总线（EventEmitter）**将后端错误推送到前端，触发弹窗提示，错误信息包含“错误码+原因建议+重试选项”。


### 6. 安全与合规
- 登录信息（密码、Cookie）采用**加密存储**（如AES加密+系统密钥链），避免明文泄露。
- 明确API调用的**频率限制与合规声明**，错误提醒中加入“合规使用”引导，防止触发B站反爬机制。


## 五、其他需求

### 1. 纯净性与体验
- **无广告**：软件全程无弹窗广告、水印，保持纯净。
- **轻量化**：安装包体积小，运行时资源占用低（通过多线程调度与内存优化实现）。


### 2. 迭代与反馈
- **版本更新**：支持自动检测新版本并提示更新（或手动检查更新）。
- **用户帮助**：提供在线文档链接指导使用，支持简易反馈渠道（如赞助入口、问题提交链接）。


### 3. 法律与合规
- 明确软件仅用于**个人学习、研究等非商业用途**，遵守B站用户协议与相关法律法规。